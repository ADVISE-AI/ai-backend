INFO:     Will watch for changes in these directories: ['/home/darkus/Desktop/AdviseProject/ai-backend']
INFO:     Uvicorn running on http://127.0.0.1:5000 (Press CTRL+C to quit)
INFO:     Started reloader process [86183] using StatReload
‚öôÔ∏è  Running without SSL (Development mode)
üîÑ Auto-reload enabled (Development mode)
============================================================
üöÄ Environment: development
Workers:      1
SSL:          ‚ùå Disabled
============================================================
2025-11-20T23:43:44,116 INFO     [db.py:36] Initializing database for PID 86186
2025-11-20T23:43:44,246 INFO     [db.py:80] ‚úÖ Database initialized for PID 86186 (pool_size=5, max_overflow=10)
2025-11-20T23:43:45,130 INFO     [bot.py:314] Gemini system prompt loaded successfully
2025-11-20T23:43:45,657 INFO     [bot.py:327] Gemini model initialized successfully
2025-11-20T23:43:45,658 INFO     [bot.py:414] LangGraph graph built successfully
2025-11-20T23:43:45,658 INFO     [bot.py:534] bot.py module loaded successfully
2025-11-20T23:43:45,659 INFO     [message_deduplicator.py:15] Connecting to Redis at localhost:6379
2025-11-20T23:43:45,661 INFO     [message_deduplicator.py:18] ‚úÖ Redis connection established
2025-11-20T23:43:45,716 INFO     [message_buffer.py:29] Message buffer Redis connection established
2025-11-20T23:43:45,716 INFO     [message_buffer.py:317] Created new message buffer instance
2025-11-20T23:43:45,736 INFO     [app.py:140] ‚úÖ All routers registered
INFO:     Started server process [86186]
INFO:     Waiting for application startup.
2025-11-20T23:43:45,737 INFO     [app.py:36] üöÄ Starting WhatsApp AI Backend...
2025-11-20T23:43:45,738 INFO     [app.py:43] ‚úÖ Database connection verified
2025-11-20T23:43:45,741 INFO     [app.py:53] ‚úÖ Redis connection verified
2025-11-20T23:43:45,742 INFO     [app.py:58] ‚úÖ All systems operational
INFO:     Application startup complete.
2025-11-20T23:45:19,001 INFO     [app.py:110] ‚Üí POST /webhook from 2a03:2880:22ff:7::
2025-11-20T23:45:19,002 INFO     [webhook.py:72] RECEIVED WHATSAPP WEBHOOK DATA: {
  "object": "whatsapp_business_account",
  "entry": [
    {
      "id": "1124430582490621",
      "changes": [
        {
          "value": {
            "messaging_product": "whatsapp",
            "metadata": {
              "display_phone_number": "15551373346",
              "phone_number_id": "742452155624690"
            },
            "contacts": [
              {
                "profile": {
                  "name": "Ayush"
                },
                "wa_id": "917980977361"
              }
            ],
            "messages": [
              {
                "from": "917980977361",
                "id": "wamid.HBgMOTE3OTgwOTc3MzYxFQIAEhgWM0VCMEI4Q0ZFQTQ4REUxQzA3MkNGQgA=",
                "timestamp": "1763662516",
                "text": {
                  "body": "Heyyy"
                },
                "type": "text"
              }
            ]
          },
          "field": "messages"
        }
      ]
    }
  ]
}
2025-11-20T23:45:19,004 INFO     [message_buffer.py:108] Started message buffer for 917980977361
2025-11-20T23:45:19,004 INFO     [webhook.py:119] Scheduling buffer check for 917980977361 in 2 seconds
2025-11-20T23:45:19,008 DEBUG    [functional.py:335] 
def check_buffer_task(phone):
    return 1

2025-11-20T23:45:19,039 INFO     [app.py:118] ‚Üê 200 for /webhook
INFO:     2a03:2880:22ff:7:::0 - "POST /webhook HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-21T00:20:38,264 INFO     [app.py:63] üõë Shutting down WhatsApp AI Backend...
2025-11-21T00:20:38,264 INFO     [app.py:68] ‚úÖ Database connections closed
2025-11-21T00:20:38,264 INFO     [app.py:72] üëã Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [86186]
INFO:     Stopping reloader process [86183]
